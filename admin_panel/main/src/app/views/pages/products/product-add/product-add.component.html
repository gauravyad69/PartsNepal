<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h3>Add New Product</h3>
    </div>
    <div class="card-body">
      <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
        <!-- Basic Information -->
        <div formGroupName="basic">
          <h5>Basic Information</h5>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Product Name*</label>
              <input type="text" class="form-control" formControlName="productName">
            </div>
            <div class="col-md-3">
              <label class="form-label">SKU*</label>
              <input type="text" class="form-control" formControlName="productSKU">
            </div>
            <div class="col-md-3">
              <label class="form-label">Category ID*</label>
              <input type="number" class="form-control" formControlName="categoryId">
            </div>

            <!-- Inventory -->
            <div class="col-12" formGroupName="inventory">
              <h6>Inventory</h6>
              <div class="row g-3">
                <div class="col-md-4">
                  <label class="form-label">Stock*</label>
                  <input type="number" class="form-control" formControlName="stock">
                </div>
                <div class="col-md-4">
                  <label class="form-label">Main Image URL*</label>
                  <input type="text" class="form-control" formControlName="mainImage">
                </div>
                <div class="col-md-4">
                  <label class="form-label">Available</label>
                  <div class="form-check mt-2">
                    <input type="checkbox" class="form-check-input" formControlName="isAvailable">
                    <label class="form-check-label">Is Available</label>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pricing -->
            <div class="col-12" formGroupName="pricing">
              <h6>Pricing</h6>
              <div class="row g-3">
                <div class="col-md-4" formGroupName="regularPrice">
                  <label class="form-label">Regular Price (NPR)*</label>
                  <input type="number" class="form-control" formControlName="amount">
                </div>
                <div class="col-md-4" formGroupName="salePrice">
                  <label class="form-label">Sale Price (NPR)</label>
                  <input type="number" class="form-control" formControlName="amount">
                </div>
                
                <!-- Discount -->
                <div class="col-md-4" formGroupName="discount">
                  <label class="form-label">Discount</label>
                  <div formGroupName="amount">
                    <input type="number" class="form-control mb-2" formControlName="amount" placeholder="Amount">
                  </div>
                  <select class="form-select mb-2" formControlName="type">
                    @for (type of discountTypes; track type) {
                      <option [value]="type">{{type}}</option>
                    }
                  </select>
                  <input type="text" class="form-control mb-2" formControlName="description" placeholder="Description">
                  <div class="row g-2">
                    <div class="col-6">
                      <input type="date" class="form-control" formControlName="startDate" placeholder="Start Date">
                    </div>
                    <div class="col-6">
                      <input type="date" class="form-control" formControlName="endDate" placeholder="End Date">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Details -->
        <div formGroupName="details" class="mt-4">
          <h5>Product Details</h5>
          <div class="row g-3">
            <div class="col-12">
              <label class="form-label">Description*</label>
              <textarea class="form-control" rows="3" formControlName="description"></textarea>
            </div>

            <!-- Features -->
            <div class="col-12" formGroupName="features">
              <h6>Features</h6>
              
              <!-- Highlights -->
              <div class="mb-3">
                <label class="form-label">Highlights</label>
                <div class="highlight-list">
                  @for (highlight of highlights; track $index) {
                    <div class="input-group mb-2">
                      <input type="text" class="form-control" [(ngModel)]="highlights[$index]" 
                             [ngModelOptions]="{standalone: true}"
                             (blur)="updateHighlights()">
                      <button type="button" class="btn btn-danger" (click)="removeHighlight($index)">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  }
                </div>
                <button type="button" class="btn btn-secondary" (click)="addHighlight()">
                  <i class="fas fa-plus"></i> Add Highlight
                </button>
              </div>

              <!-- Additional Images -->
              <div class="mb-3">
                <label class="form-label">Additional Images</label>
                <div class="image-list">
                  @for (image of imageUrls; track $index) {
                    <div class="input-group mb-2">
                      <input type="text" class="form-control" [(ngModel)]="imageUrls[$index].url" 
                             [ngModelOptions]="{standalone: true}"
                             placeholder="Image URL"
                             (blur)="updateImages()">
                      <input type="text" class="form-control" [(ngModel)]="imageUrls[$index].alt" 
                             [ngModelOptions]="{standalone: true}"
                             placeholder="Alt Text"
                             (blur)="updateImages()">
                      <div class="input-group-text">
                        <input type="checkbox" class="form-check-input mt-0" 
                               [(ngModel)]="imageUrls[$index].isPrimary"
                               [ngModelOptions]="{standalone: true}"
                               (change)="updateImages()">
                        <label class="form-check-label ms-2">Primary</label>
                      </div>
                      <button type="button" class="btn btn-danger" (click)="removeImageUrl($index)">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  }
                </div>
                <button type="button" class="btn btn-secondary" (click)="addImageUrl()">
                  <i class="fas fa-plus"></i> Add Image
                </button>
              </div>
            </div>

            <!-- Delivery -->
            <div class="col-12" formGroupName="delivery">
              <h6>Delivery Information</h6>
              <div class="row g-3">
                <div class="col-md-4" formGroupName="shippingCost">
                  <label class="form-label">Shipping Cost (NPR)</label>
                  <input type="number" class="form-control" formControlName="amount">
                </div>
                <div class="col-md-4">
                  <label class="form-label">Estimated Days*</label>
                  <input type="number" class="form-control" formControlName="estimatedDays">
                </div>
                <div class="col-md-4">
                  <label class="form-label">Delivery Options</label>
                  <select class="form-select" formControlName="options" multiple>
                    @for (option of deliveryOptions; track option) {
                      <option [value]="option">{{option}}</option>
                    }
                  </select>
                </div>
              </div>
            </div>

            <!-- Warranty -->
            <div class="col-12" formGroupName="warranty">
              <h6>Warranty Information</h6>
              <div class="row g-3">
                <div class="col-md-4">
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" formControlName="isReturnable">
                    <label class="form-check-label">Is Returnable</label>
                  </div>
                </div>
                <div class="col-md-4">
                  <label class="form-label">Return Period (Days)</label>
                  <input type="number" class="form-control" formControlName="returnPeriodDays">
                </div>
                <div class="col-md-4">
                  <label class="form-label">Warranty (Months)</label>
                  <input type="number" class="form-control" formControlName="warrantyMonths">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
            <i class="fas fa-save"></i> Create Product
          </button>
          <button type="button" class="btn btn-secondary ms-2" routerLink="/products">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div> 