<section class="bg-warning padding-y-sm rounded">
    <div class="container">
        <ol class="breadcrumb ondark mb-0">
            <li class="breadcrumb-item">
                <a routerLink="/products">Home</a>
            </li>
            <li class="breadcrumb-item">
                <a routerLink="/products">Product</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                {{product?.basic?.productName}}
            </li>
        </ol>
    </div>
</section>

<section class="padding-y">
    <div class="container">
        <div class="row">
            <aside class="col-lg-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Product Images</h5>
                        <owl-carousel-o [options]="slider1Settings" #myCarousel>
                            @for (slide of product?.details?.features?.images ?? []; track slide?.url) {
                                <ng-template carouselSlide [id]="slide?.toString() ?? ''">
                                    <figure class="zoom-image" style="background-image: url({{slide?.url}});"
                                        [style.backgroundPosition]="backgroundPos" (mousemove)="ZoomImage($event)">
                                        <img class="rounded" src="{{slide?.url}}" alt="Product image"
                                            (error)="onImageError($event)">
                                    </figure>
                                </ng-template>
                            }
                        </owl-carousel-o>
                    </div>
                </div>
            </aside>

            <main class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 class="card-title">Product Details</h4>
                            <div class="btn-group">
                                <button *ngIf="!isEditing" class="btn btn-primary" (click)="startEditing()">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button *ngIf="isEditing" class="btn btn-success" (click)="saveChanges()">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                                <button *ngIf="isEditing" class="btn btn-danger" (click)="cancelEditing()">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>

                        <form #productForm="ngForm">
                            <!-- Basic Information -->
                            <h5 class="mt-4">Basic Information</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Product Name</label>
                                    <input type="text" class="form-control" 
                                           [ngModel]="product?.basic?.productName"
                                           (ngModelChange)="updateField('basic.productName', $event)"
                                           [readonly]="!isEditing"
                                           name="productName">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">SKU</label>
                                    <input type="text" class="form-control" 
                                           [ngModel]="product?.basic?.productSKU"
                                           (ngModelChange)="updateField('basic.productSKU', $event)"
                                           [readonly]="!isEditing"
                                           name="sku">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Category ID</label>
                                    <input type="number" class="form-control" 
                                           [ngModel]="product?.basic?.categoryId"
                                           (ngModelChange)="updateField('basic.categoryId', $event)"
                                           [readonly]="!isEditing"
                                           name="categoryId">
                                </div>
                            </div>

                            <!-- Inventory -->
                            <h5 class="mt-4">Inventory</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Stock</label>
                                    <input type="number" class="form-control" 
                                           [ngModel]="product?.basic?.inventory?.stock"
                                           (ngModelChange)="updateField('basic.inventory.stock', $event)"
                                           [readonly]="!isEditing"
                                           name="stock">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Status</label>
                                    <div class="form-control">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" 
                                                   [ngModel]="product?.basic?.inventory?.isAvailable"
                                                   (ngModelChange)="updateField('basic.inventory.isAvailable', $event)"
                                                   [disabled]="!isEditing"
                                                   name="isAvailable">
                                            <label class="form-check-label">Available</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Pricing -->
                            <h5 class="mt-4">Pricing</h5>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label">Regular Price</label>
                                    <input type="number" class="form-control" 
                                           [ngModel]="product?.basic?.pricing?.regularPrice?.amount | priceFormat"
                                           (ngModelChange)="updateField('basic.pricing.regularPrice.amount', $event)"
                                           [readonly]="!isEditing"
                                           name="regularPrice">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Sale Price</label>
                                    <input type="number" class="form-control" 
                                           [ngModel]="product?.basic?.pricing?.salePrice?.amount | priceFormat"
                                           (ngModelChange)="updateField('basic.pricing.salePrice.amount', $event)"
                                           [readonly]="!isEditing"
                                           name="salePrice">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Discount Percentage</label>
                                    <input type="number" class="form-control" 
                                           [ngModel]="product?.basic?.pricing?.discount?.amount?.amount | priceFormat"
                                           (ngModelChange)="updateField('basic.pricing.discount.amount.amount', $event)"
                                           [readonly]="!isEditing"
                                           name="discountPercentage">
                                </div>
                            </div>

                            <!-- Description -->
                            <h5 class="mt-4">Description</h5>
                            <div class="row g-3">
                                <div class="col-12">
                                    <textarea class="form-control" rows="4" 
                                              [ngModel]="product?.details?.description"
                                              (ngModelChange)="updateField('details.description', $event)"
                                              [readonly]="!isEditing"
                                              name="description"></textarea>
                                </div>
                            </div>

                            <div class="mt-3">
                                <small class="text-muted">
                                    <!-- Last Updated: {{product?.lastUpdated | date:'medium'}} 
                                    | Version: {{product?.version}} -->
                                </small>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>
</section> 